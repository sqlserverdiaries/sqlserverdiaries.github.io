<!DOCTYPE html>
<html lang="en">
  <!-- Beautiful Jekyll | MIT license | Copyright Dean Attali 2020 -->
  <head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <title>Generate Lottery Ticket Combinations</title>
  
  
  <meta name="author" content="Reuben Sultana">
  
  
  

  <link rel="alternate" type="application/rss+xml" title="SQL Server Diaries - A personal take on SQL Server solutions" href="http://0.0.0.0:4000/feed.xml">

  

  

  


  
    
      
  <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">


    
      
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css">


    
      
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic">


    
      
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800">


    
  

  
    
      <link rel="stylesheet" href="/assets/css/bootstrap-social.css">
    
      <link rel="stylesheet" href="/assets/css/main.css">
    
  

  

  

  <!-- Facebook OpenGraph tags -->
  

  
  <meta property="og:title" content="Generate Lottery Ticket Combinations">
  

   
  <meta property="og:description" content="In Malta, the Super 5 lottery prize has always been considered the peak of winnings by the Maltese.  So much so that it has become part of the day-to-day language when referring to good luck (I feel I just won the Super 5!).  As a challenge, I thought of how...">
  


  <meta property="og:type" content="website">

  
  <meta property="og:url" content="http://0.0.0.0:4000/blog/index.php/2011/03/12/generate-lottery-ticket-combinations/">
  <link rel="canonical" href="http://0.0.0.0:4000/blog/index.php/2011/03/12/generate-lottery-ticket-combinations/">
  

  


  <!-- Twitter summary cards -->
  <meta name="twitter:card" content="summary">
  <meta name="twitter:site" content="@reubensultana">
  <meta name="twitter:creator" content="@reubensultana">

  
  <meta name="twitter:title" content="Generate Lottery Ticket Combinations">
  

  
  <meta name="twitter:description" content="In Malta, the Super 5 lottery prize has always been considered the peak of winnings by the Maltese.  So much so that it has become part of the day-to-day language when referring to good luck (I feel I just won the Super 5!).  As a challenge, I thought of how...">
  

  

  

  

</head>


  <body>

    

  
    <nav class="navbar navbar-expand-md navbar-light fixed-top navbar-custom "><a class="navbar-brand" href="http://0.0.0.0:4000/">SQL Server Diaries</a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#main-navbar" aria-controls="main-navbar" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  <div class="collapse navbar-collapse" id="main-navbar">
    <ul class="navbar-nav ml-auto">
          <li class="nav-item">
            <a class="nav-link" href="/">Home</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/about">About Me</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/tags">Tags</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="https://reubensultana.com">Author's home</a>
          </li></ul>
  </div>

  

</nav>


    <!-- TODO this file has become a mess, refactor it -->







<header class="header-section ">

<div class="intro-header no-img">
  <div class="container-md">
    <div class="row">
      <div class="col-xl-8 offset-xl-2 col-lg-10 offset-lg-1">
        <div class="post-heading">
          <h1>Generate Lottery Ticket Combinations</h1>
      
      
      
          <span class="post-meta">Posted on March 12, 2011</span>
          
            <!--- "ReadTime on GitHub Jekyll" (c) 2020 Ruby Griffith Ramirez, MIT License -->






  
  <span class="reader-time post-meta"><span class="d-none d-md-inline middot">&middot;</span> 2 minute read</span>


          
      
        </div>
      </div>
    </div>
  </div>
</div>
</header>





<div class="container-md">
  <div class="row">
    <div class="col-xl-8 offset-xl-2 col-lg-10 offset-lg-1">

      

      <article role="main" class="blog-post">
        <p>In Malta, the <a href="http://www.maltco.com/super/">Super 5</a> lottery prize has always been considered the peak of winnings by the Maltese.  So much so that it has become part of the day-to-day language when referring to good luck (<em>I feel I just won the Super 5!</em>).  As a challenge, I thought of how to write a T-SQL statement that would retrieve all the possible combinations (or permutations) of the tickets.  As a backround to the lottery, the wining ticket will contain 5 distinct numbers between 1 and 42 in any order.  Each ticket costs €1.50 and draws are held once a week.</p>

<p>First we have to generate the range (array) of numbers which can be played.  Available in SQL Server 2005 and later are the Common Table Expressions (CTE) - more information about CTE’s can be found in the <a href="http://msdn.microsoft.com/en-us/library/ms130214.aspx">SQL Server Books Online</a>.</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">WITH</span> <span class="n">cte_Numbers</span> <span class="p">(</span><span class="n">number</span><span class="p">)</span> <span class="k">AS</span> <span class="p">(</span>
    <span class="k">SELECT</span> <span class="mi">1</span> <span class="k">AS</span> <span class="p">[</span><span class="n">number</span><span class="p">]</span>
    <span class="k">UNION</span> <span class="k">ALL</span>
    <span class="k">SELECT</span> <span class="p">[</span><span class="n">number</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="k">FROM</span> <span class="n">cte_Numbers</span> <span class="k">WHERE</span> <span class="p">[</span><span class="n">number</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">42</span> <span class="p">)</span>
<span class="k">SELECT</span> <span class="p">[</span><span class="n">number</span><span class="p">]</span>
<span class="k">FROM</span> <span class="n">cte_Numbers</span><span class="p">;</span>
</code></pre></div></div>

<p>The next step is creating the number combinations.  Since the largest number is 42, this means that there are 42 numbers that can be drawn first, then 41, then 40, and so forth.</p>

<blockquote>
  <p>42 x 41 x 40 x 39 x 38 = 102,080,160</p>
</blockquote>

<p>This brings the odds of winning at over 102 million to one.  Since the order of the draws does not matter, the above should be divided by the number of ways the numbers can be drawn:</p>

<blockquote>
  <p>5 x 4 x 3 x 2 x 1 = 120</p>
</blockquote>

<p>To calculate the odds of winning with one ticket we divide the first result by the latter:</p>

<blockquote>
  <p>102,080,160 / 120 = 850,668</p>
</blockquote>

<p>This brings the odds of winning down to over 850 thousand to one. In theory, if one had to buy all the tickets costing 850,668 x €1.50 one would have to spend €1,276,002.</p>

<p>Back to the ticket generator.  In order to generate all possible combinations we shall utilise the Cartesian Product of five CROSS JOINs from the result of the original CTE as shown below.  Since each number can be drawn only once the WHERE clause will remove the one’s already drawn.</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">WITH</span> <span class="n">cte_Numbers</span> <span class="p">(</span><span class="n">number</span><span class="p">)</span> <span class="k">AS</span> <span class="p">(</span>
    <span class="k">SELECT</span> <span class="mi">1</span> <span class="k">AS</span> <span class="p">[</span><span class="n">number</span><span class="p">]</span>
    <span class="k">UNION</span> <span class="k">ALL</span>
    <span class="k">SELECT</span> <span class="p">[</span><span class="n">number</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="k">FROM</span> <span class="n">cte_Numbers</span> <span class="k">WHERE</span> <span class="p">[</span><span class="n">number</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">42</span> <span class="p">)</span>
<span class="k">SELECT</span>
    <span class="k">CAST</span><span class="p">(</span><span class="n">a</span><span class="p">.[</span><span class="n">number</span><span class="p">]</span> <span class="k">AS</span> <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="o">+</span> <span class="s1">'-'</span> <span class="o">+</span>
    <span class="k">CAST</span><span class="p">(</span><span class="n">b</span><span class="p">.[</span><span class="n">number</span><span class="p">]</span> <span class="k">AS</span> <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="o">+</span> <span class="s1">'-'</span> <span class="o">+</span>
    <span class="k">CAST</span><span class="p">(</span><span class="k">c</span><span class="p">.[</span><span class="n">number</span><span class="p">]</span> <span class="k">AS</span> <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="o">+</span> <span class="s1">'-'</span> <span class="o">+</span>
    <span class="k">CAST</span><span class="p">(</span><span class="n">d</span><span class="p">.[</span><span class="n">number</span><span class="p">]</span> <span class="k">AS</span> <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="o">+</span> <span class="s1">'-'</span> <span class="o">+</span>
    <span class="k">CAST</span><span class="p">(</span><span class="n">e</span><span class="p">.[</span><span class="n">number</span><span class="p">]</span> <span class="k">AS</span> <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="k">AS</span> <span class="p">[</span><span class="n">Combinations</span><span class="p">]</span>
<span class="k">FROM</span> <span class="n">cte_Numbers</span> <span class="n">a</span>
    <span class="k">CROSS</span> <span class="k">JOIN</span> <span class="n">cte_Numbers</span> <span class="n">b</span>
    <span class="k">CROSS</span> <span class="k">JOIN</span> <span class="n">cte_Numbers</span> <span class="k">c</span>
    <span class="k">CROSS</span> <span class="k">JOIN</span> <span class="n">cte_Numbers</span> <span class="n">d</span>
    <span class="k">CROSS</span> <span class="k">JOIN</span> <span class="n">cte_Numbers</span> <span class="n">e</span>
<span class="k">WHERE</span> <span class="p">(</span><span class="n">b</span><span class="p">.[</span><span class="n">number</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">a</span><span class="p">.[</span><span class="n">number</span><span class="p">])</span> <span class="k">AND</span>
    <span class="p">(</span><span class="k">c</span><span class="p">.[</span><span class="n">number</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">b</span><span class="p">.[</span><span class="n">number</span><span class="p">])</span> <span class="k">AND</span>
    <span class="p">(</span><span class="n">d</span><span class="p">.[</span><span class="n">number</span><span class="p">]</span> <span class="o">&gt;</span> <span class="k">c</span><span class="p">.[</span><span class="n">number</span><span class="p">])</span> <span class="k">AND</span>
    <span class="p">(</span><span class="n">e</span><span class="p">.[</span><span class="n">number</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">d</span><span class="p">.[</span><span class="n">number</span><span class="p">]);</span>
</code></pre></div></div>

<p>Actually that’s it.  The above query will return all possible ticket combinations for the Maltese Super 5 lottery.</p>

<p>Good luck!</p>

      </article>

      
        <div class="blog-tags">
          Tags:
          
          
            <a href="/tags#T-SQL Programming">T-SQL Programming</a>
          
            <a href="/tags#Code Samples">Code Samples</a>
          
            <a href="/tags#CTE">CTE</a>
          
            <a href="/tags#CROSS JOIN">CROSS JOIN</a>
          
            <a href="/tags#Permutations">Permutations</a>
          
            <a href="/tags#Combinations">Combinations</a>
          
            <a href="/tags#SQL Server">SQL Server</a>
          
          
        </div>
      

      
        <!-- Check if any share-links are active -->




<section id = "social-share-section">
  <span class="sr-only">Share: </span>

  
    <a href="https://twitter.com/intent/tweet?text=Generate+Lottery+Ticket+Combinations&url=http%3A%2F%2F0.0.0.0%3A4000%2Fblog%2Findex.php%2F2011%2F03%2F12%2Fgenerate-lottery-ticket-combinations%2F"
      class="btn btn-social-icon btn-twitter" title="Share on Twitter">
      <span class="fab fa-fw fa-twitter" aria-hidden="true"></span>
      <span class="sr-only">Twitter</span>
    </a>
  

  
    <a href="https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2F0.0.0.0%3A4000%2Fblog%2Findex.php%2F2011%2F03%2F12%2Fgenerate-lottery-ticket-combinations%2F"
      class="btn btn-social-icon btn-facebook" title="Share on Facebook">
      <span class="fab fa-fw fa-facebook" aria-hidden="true"></span>
      <span class="sr-only">Facebook</span>
    </a>
  

  
    <a href="https://www.linkedin.com/shareArticle?mini=true&url=http%3A%2F%2F0.0.0.0%3A4000%2Fblog%2Findex.php%2F2011%2F03%2F12%2Fgenerate-lottery-ticket-combinations%2F"
      class="btn btn-social-icon btn-linkedin" title="Share on LinkedIn">
      <span class="fab fa-fw fa-linkedin" aria-hidden="true"></span>
      <span class="sr-only">LinkedIn</span>
    </a>
  

  

</section>



      

      <ul class="pagination blog-pager">
        
        <li class="page-item previous">
          <a class="page-link" href="/blog/index.php/2011/03/05/addressing-a-login-failed-error-18452-error-message-in-sql-server-2005/" data-toggle="tooltip" data-placement="top" title="Addressing a 'login failed' (Error 18452) error message in SQL Server 2005">&larr; Previous Post</a>
        </li>
        
        
        <li class="page-item next">
          <a class="page-link" href="/blog/index.php/2011/03/19/script-logins-from-database-users/" data-toggle="tooltip" data-placement="top" title="Script Logins from Database Users">Next Post &rarr;</a>
        </li>
        
      </ul>
      
    </div>
  </div>
</div>


    <footer>
  <div class="container-md beautiful-jekyll-footer">
    <div class="row">
      <div class="col-xl-8 offset-xl-2 col-lg-10 offset-lg-1">
      <ul class="list-inline text-center footer-links"><li class="list-inline-item">
    <a href="/feed.xml" title="RSS">
      <span class="fa-stack fa-lg" aria-hidden="true">
        <i class="fas fa-circle fa-stack-2x"></i>
        <i class="fas fa-rss fa-stack-1x fa-inverse"></i>
      </span>
      <span class="sr-only">RSS</span>
    </a>
  </li><li class="list-inline-item">
    <a href="mailto:info@sqlserverdiaries.com" title="Email me">
      <span class="fa-stack fa-lg" aria-hidden="true">
        <i class="fas fa-circle fa-stack-2x"></i>
        <i class="fas fa-envelope fa-stack-1x fa-inverse"></i>
      </span>
      <span class="sr-only">Email me</span>
   </a>
  </li><li class="list-inline-item">
    <a href="https://github.com/reubensultana" title="GitHub">
      <span class="fa-stack fa-lg" aria-hidden="true">
        <i class="fas fa-circle fa-stack-2x"></i>
        <i class="fab fa-github fa-stack-1x fa-inverse"></i>
      </span>
      <span class="sr-only">GitHub</span>
   </a>
  </li><li class="list-inline-item">
    <a href="https://twitter.com/reubensultana" title="Twitter">
      <span class="fa-stack fa-lg" aria-hidden="true">
        <i class="fas fa-circle fa-stack-2x"></i>
        <i class="fab fa-twitter fa-stack-1x fa-inverse"></i>
      </span>
      <span class="sr-only">Twitter</span>
   </a>
  </li><li class="list-inline-item">
    <a href="https://linkedin.com/in/reubensultana" title="LinkedIn">
      <span class="fa-stack fa-lg" aria-hidden="true">
        <i class="fas fa-circle fa-stack-2x"></i>
        <i class="fab fa-linkedin fa-stack-1x fa-inverse"></i>
      </span>
      <span class="sr-only">LinkedIn</span>
   </a>
  </li></ul>

      
      <p class="copyright text-muted">
      
        Reuben Sultana
        &nbsp;&bull;&nbsp;
      
      2020

      
        &nbsp;&bull;&nbsp;
        <a href="http://0.0.0.0:4000/">sqlserverdiaries.com</a>
      

      
      </p>
      <!-- Please don't remove this, keep my open source work credited :) -->
<!--
      <p class="theme-by text-muted">
        Theme by
        <a href="https://beautifuljekyll.com">beautiful-jekyll</a>
      </p>
-->
    </div>
    </div>
  </div>
</footer>

  
    
  
    
  <script src="https://code.jquery.com/jquery-3.4.1.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>


  
    
  <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>


  
    
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>


  



  
    <!-- doing something a bit funky here because I want to be careful not to include JQuery twice! -->
    
      <script src="/assets/js/main.js"></script>
    
  






  
  </body>
</html>
